# packs/lang/en.yaml
# English base
#
# Keep this file accent-neutral as much as possible. Put UK-specific
# pronunciation tweaks in `en-gb.yaml` and US-specific ones in `en-us.yaml`.

settings:
  # English tends to sound more natural if stressed syllables are not *too* slowed.
  # This also helps teen numbers (e.g. "14") not feel like the ending is clipped.
  primaryStressDiv: 1.4
  secondaryStressDiv: 1.1

  # English sounds clearer with explicit stop closures.
  # Stop closures help clarity, but using them *everywhere* can make the voice feel clicky,
  # especially for short chunks like key echo / character echo.
  # Keep closures mostly after vowels/clusters, and keep the gaps short.
  stopClosureMode: vowel-and-cluster
  stopClosureVowelGapMs: 26
  stopClosureVowelFadeMs: 6
  stopClosureClusterGapMs: 16
  stopClosureClusterFadeMs: 3

  # English: insert short aspiration after unvoiced stops in the right contexts.
  postStopAspirationEnabled: true

  # Keep your existing English long /uː/ shortening behavior (matches your Python logic).
  englishLongUShortenEnabled: true
  englishLongUWordFinalScale: 0.95
  englishLongUKey: "ᵾ"

  # Long vowels (ː) in word-final consonant clusters can sound over-held
  # in a formant synth (e.g. "rules" /ruːlz/, "dialog" /dʌɪəˌlɔːg/).
  # This additional scale shortens length-marked vowels when they are the
  # last vowel in a word and followed by final consonants.
  #
  # Tune per-language if needed.
  lengthenedVowelFinalCodaScale: 0.90


  # Keep length scaling close to the global default.
  # Over-lengthening can make clusters (like "-dcast") sound overly separated.

normalization:
  replacements:
    # eSpeak sometimes emits plain 'a' for TRAP. Your Python normalized that to 'æ'.
    - from: "a"
      to: "æ"

    # UK-ish long /uː/ (GOOSE) is typically more fronted than the generic /u/.
    # Our multilingual base 'u' is tuned fairly back; map long uː to a UK-specific key (ᵾ)
    # whose formants are closer to the older en-gb-tuned table.
    - from: "uː"
      to: "ᵾː"

    # Safety: some eSpeak voices omit the length mark in a few environments.
    # If that happens, still use the fronted English GOOSE vowel.
    - from: "u"
      to: "ᵾ"

    # Accent-specific vowel set tweaks live in per-region packs:
    #  - en-gb.yaml (BATH broadening, UK THOUGHT rounding, non-rhotic NURSE)
    #  - en-us.yaml (rhotic NURSE, narrow BATH, etc.)
    # Make /d͡ʒ/ a little less 'soft' by keeping the stop+fricative components explicit.
    - from: "d͡ʒ"
      to:   "dʒ"

    # Pre-fortis clipping: shorten long FLEECE before word-final /t/
    # so minimal pairs like "bead" vs "beat" are distinguishable.
    - from: "iːt"
      to:   "it"
      when:
        atWordEnd: true

    # Diphthongs/triphthongs:
    #
    # eSpeak often outputs triphthong-ish sequences like aɪə (e.g. "dialog", "fire").
    # If treated as three full vowels, the middle /ɪ/ can sound oddly elongated and the
    # following consonant can feel swallowed.
    # Tie PRICE (aɪ) before schwa to keep the glide natural without over-stretching.
    - from: "aɪə"
      to:   "a͡ɪə"

    # Tie FACE diphthong (eɪ) so words like "player" do not come out as "play-ay-er".
    # eSpeak marks this with a ZWJ (e‍ɪ); we strip ZWJ globally, so we re-tie it here.
    - from: "eɪ"
      to:   "e͡ɪ"


    # Word-final NEAR/SQUARE/CURE:
    # Keep the nucleus bright (i) but end with a short, neutral-ish offglide.
    # We use a dedicated English-only offglide (ᵊᵉ) so we can tune it without
    # affecting other languages that use the generic ᵊ.
    # Only do this at word end so we do not disturb sequences inside words like "dialog".
    - from: "iə"
      to:   "iᵊᵉ"
      when:
        atWordEnd: true
    - from: "ɪɹ"
      to:   "iɹ"
      when:
        atWordEnd: true

    # -ily endings: eSpeak en/en-gb/en-ca sometimes uses FLEECE (i) where KIT (ɪ) is more natural
    # (readily/lazily/angrily/easily...).
    - from: "ili"
      to:   "ɪli"
      when:
        atWordEnd: true